(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     76059,       1755]
NotebookOptionsPosition[     70999,       1663]
NotebookOutlinePosition[     71400,       1679]
CellTagsIndexPosition[     71357,       1676]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FetchData", "[", "filename_", "]"}], ":=", "  ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], 
     "<>", "\"\<../data/simulation/\>\"", "<>", "filename"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportData", "[", 
    RowBox[{"filename_", ",", " ", "data_"}], "]"}], ":=", " ", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      "<>", "\"\<../data/simulation/\>\"", "<>", "filename"}], ",", " ", 
     "data"}], "]"}]}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9687564362149124`*^9, 3.9687564362149124`*^9}, {
   3.968756500702917*^9, 3.9687565040669518`*^9}, {3.9687568786249847`*^9, 
   3.9687568900349483`*^9}, {3.96875829451412*^9, 3.9687583005771008`*^9}, {
   3.968843799697901*^9, 3.968843799820795*^9}, {3.968844434171139*^9, 
   3.968844464391981*^9}, {3.9688446135259705`*^9, 3.968844694537945*^9}, {
   3.968844783226019*^9, 3.9688447860860615`*^9}, 3.9688449340630054`*^9, 
   3.96890959522843*^9, {3.9694644266297913`*^9, 3.96946442698884*^9}},
 Background->RGBColor[1, 0.75, 0],
 CellLabel->"In[24]:=",ExpressionUUID->"939ec6e9-c18f-b54a-912f-9e3e54efb049"],

Cell[CellGroupData[{

Cell["Generate agents", "Section",
 CellChangeTimes->{{3.9688493098892365`*^9, 
  3.96884931338262*^9}},ExpressionUUID->"39dbf734-9b61-6c48-896c-\
6e59dc3fd660"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<GenerateAgentsUniform\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateAgentsUniform", "[", 
     RowBox[{"nAgents_", ",", "nNodes_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "nNodes"}], "}"}], "]"}], ",", "nAgents"}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<GenerateOccupanciesUniform\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateOccupanciesUniform", "[", 
    RowBox[{"nAgents_", ",", "nNodes_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "occupancies", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"occupancies", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", "nNodes"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"occupancies", "[", 
          RowBox[{"[", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "nNodes"}], "}"}], "]"}], "]"}], "]"}], 
         "++"}], ",", " ", "nAgents"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "occupancies"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.968849313904398*^9, 3.9688493262231464`*^9}, {
  3.968911517149582*^9, 3.9689115296458664`*^9}, {3.9693480028695927`*^9, 
  3.9693480837334557`*^9}},
 Background->RGBColor[0.8, 0.3, 0.8, 0.33],
 CellLabel->"In[18]:=",ExpressionUUID->"49fe4d56-4856-6d40-8724-431297aa339e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prepare data", "Section",
 CellChangeTimes->{{3.969002072044628*^9, 3.969002074593113*^9}, 
   3.96946491355682*^9},ExpressionUUID->"f37dac47-54e5-d647-866c-\
8bbf1483fcc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<ComputeCumRatesAndLinks\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ComputeCumRatesAndLinks", "[", 
    RowBox[{"g_", ",", " ", "w_", ",", " ", 
     RowBox[{"arrayStart_", ":", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxLinks", ",", " ", "nodeCount", ",", "lists"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxLinks", " ", "=", " ", 
       RowBox[{"Max", "@", 
        RowBox[{"VertexDegree", "@", "g"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nodeCount", " ", "=", " ", 
       RowBox[{"Length", "@", "w"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"On", "[", "Assert", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lists", " ", "=", " ", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "col", ",", " ", "cumulativeRate", ",", " ", "nodeRates", ",", 
             " ", "nodeLinks", ",", " ", "i", ",", " ", "rate"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"col", " ", "=", " ", 
             RowBox[{"Normal", "@", 
              RowBox[{"w", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"Assert", "[", 
             RowBox[{
              RowBox[{"Total", "@", "col"}], " ", "==", " ", "1"}], "]"}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"cumulativeRate", " ", "=", " ", "0"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nodeRates", " ", "=", " ", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"nodeLinks", " ", "=", " ", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Compute", " ", "cumulative", " ", "rates", " ", "so", " ", 
              "random", " ", "choice", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "have", " ", "to", " ", 
              "loop", " ", "through", " ", "the", " ", "whole", " ", 
              "matrix"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Assert", "[", 
             RowBox[{
              RowBox[{"Length", "@", "col"}], " ", "==", " ", "nodeCount"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
              RowBox[{"i", " ", "<=", " ", "nodeCount"}], ",", " ", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rate", " ", "=", " ", 
                RowBox[{"col", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"rate", " ", "==", " ", "0"}], ",", " ", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"cumulativeRate", " ", "+=", " ", "rate"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"nodeRates", ",", " ", "cumulativeRate"}], "]"}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"nodeLinks", ",", " ", 
                 RowBox[{"i", "-", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "arrayStart"}], ")"}]}]}], "]"}], 
               ";"}]}], " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"C", "++"}], " ", "counts", " ", "from", " ", 
               RowBox[{"zero", ".", " ", "Mathematica"}], " ", "from", " ", 
               "1."}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Assert", "[", 
             RowBox[{
              RowBox[{"Max", "@", "nodeRates"}], " ", "==", " ", "1"}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"Assert", "[", 
             RowBox[{
              RowBox[{"Length", "@", "nodeRates"}], " ", "<=", " ", 
              "maxLinks"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Assert", "[", 
             RowBox[{
              RowBox[{"Length", "@", "nodeLinks"}], " ", "<=", " ", 
              "maxLinks"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Assert", "[", 
             RowBox[{
              RowBox[{"Length", "@", "nodeRates"}], " ", "==", " ", 
              RowBox[{"Length", "@", "nodeLinks"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Since", " ", "array", " ", "has", " ", "to", " ", "be", " ", 
               "square"}], ",", " ", 
              RowBox[{
              "we", " ", "fill", " ", "it", " ", "with", " ", "invalid", " ", 
               "values"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "nodeRates"}], " ", "<", " ", 
               "maxLinks"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"nodeRates", ",", " ", 
                 RowBox[{"-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"nodeLinks", ",", " ", 
                 RowBox[{"-", "1"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"nodeRates", ",", " ", "nodeLinks"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", "nodeCount"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Transpose", "@", "lists"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.969002219853487*^9, 3.9690023337854347`*^9}, {
   3.969002364372116*^9, 3.969002473943474*^9}, {3.969002510296171*^9, 
   3.9690025876911755`*^9}, {3.969002625032921*^9, 3.9690028962963276`*^9}, {
   3.9690029614014606`*^9, 3.969003017571127*^9}, {3.9690031097986183`*^9, 
   3.9690031142422104`*^9}, {3.9690031612607594`*^9, 
   3.9690031972544613`*^9}, {3.969004057979225*^9, 3.9690040754980507`*^9}, {
   3.9690041466273212`*^9, 3.969004168969284*^9}, {3.9690042676451263`*^9, 
   3.9690043568586426`*^9}, {3.969004405509281*^9, 3.9690044337620316`*^9}, {
   3.969004521184849*^9, 3.96900452835363*^9}, {3.9690045803820744`*^9, 
   3.969004607726143*^9}, {3.96900466170677*^9, 3.969004699795479*^9}, {
   3.969004801596447*^9, 3.969004858324953*^9}, {3.969004897442093*^9, 
   3.9690048982022343`*^9}, {3.969005000871252*^9, 3.9690050035144615`*^9}, {
   3.969005365090788*^9, 3.9690054576340694`*^9}, {3.969005558535698*^9, 
   3.969005560629101*^9}, {3.969005634588913*^9, 3.9690056461328545`*^9}, 
   3.9690063838537445`*^9, {3.9690064213551655`*^9, 3.9690064350364437`*^9}, {
   3.9690064964563694`*^9, 3.969006549699848*^9}, {3.96900730911397*^9, 
   3.9690073157141724`*^9}, {3.969007769810152*^9, 3.969007783863188*^9}, 
   3.9690079654962254`*^9, {3.969008013904951*^9, 3.9690080180122375`*^9}, {
   3.9690080595485096`*^9, 3.9690080637234173`*^9}, {3.969008233652771*^9, 
   3.9690082610900993`*^9}, {3.969008506053549*^9, 3.96900850739555*^9}, {
   3.9693497833231125`*^9, 3.9693499061720715`*^9}, {3.969353554918211*^9, 
   3.9693535608562164`*^9}, {3.9693544008356133`*^9, 3.969354480430887*^9}, {
   3.969354526151596*^9, 3.9693545269933815`*^9}, {3.969354558107647*^9, 
   3.9693546221960735`*^9}},
 Background->RGBColor[0.8, 0.3, 0.8, 0.33],
 CellLabel->"In[16]:=",ExpressionUUID->"fc9e5a63-85df-254b-843a-04c92844d549"],

Cell[CellGroupData[{

Cell["Prepare data for CUDA sim", "Subsection",
 CellChangeTimes->{{3.9693536769156933`*^9, 3.969353677724695*^9}, {
  3.9694407639601974`*^9, 3.9694407798812485`*^9}, {3.9694649067886467`*^9, 
  3.969464910294159*^9}},ExpressionUUID->"e117ba6d-e4cb-ac4a-8cc0-\
b079dc32f9a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-naive.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", " ", 
   RowBox[{"result", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkList", " ", "=", " ", 
    RowBox[{"result", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"N", ",", " ", "rateList", ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<cumulative-rates-naive.csv\>\"", ",", " ", "rateList"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list.csv\>\"", ",", " ", "linkList"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9690020951847363`*^9, 3.969002095295454*^9}, {
  3.969006477565653*^9, 3.969006478807495*^9}, {3.969006574941559*^9, 
  3.9690066221439514`*^9}, {3.969007054965084*^9, 3.969007055354599*^9}, {
  3.969007470107279*^9, 3.9690074720428104`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"42f879a4-ebe2-4c4c-b095-b0da5f5bf603"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-speed.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", " ", 
   RowBox[{"result", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkList", " ", "=", " ", 
    RowBox[{"result", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"N", ",", " ", "rateList", ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<cumulative-rates-speed.csv\>\"", ",", " ", "rateList"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list-speed.csv\>\"", ",", " ", "linkList"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9690074796937065`*^9, 3.9690074983633137`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[390]:=",ExpressionUUID->"4bc5b48b-8fd4-d147-8fc6-a146ab065cfd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-time-morning.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", " ", 
   RowBox[{"result", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkList", " ", "=", " ", 
    RowBox[{"result", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"N", ",", " ", "rateList", ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<cumulative-rates-time.csv\>\"", ",", " ", "rateList"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list-time-morning.csv\>\"", ",", " ", "linkList"}], 
   "]"}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.969008343583042*^9, 3.9690083545049934`*^9}, {
  3.969009061825344*^9, 3.969009067064554*^9}, {3.969010627086128*^9, 
  3.9690106321221237`*^9}, {3.9693534210132656`*^9, 3.969353423693159*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[476]:=",ExpressionUUID->"bdf3479a-fddc-9446-a928-fac2672b0903"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-time-evening.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", " ", 
   RowBox[{"result", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkList", " ", "=", " ", 
    RowBox[{"result", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rateList", " ", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"N", ",", " ", "rateList", ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<cumulative-rates-time.csv\>\"", ",", " ", "rateList"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list-time-evening.csv\>\"", ",", " ", "linkList"}], 
   "]"}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.969008343583042*^9, 3.9690083545049934`*^9}, {
  3.969009061825344*^9, 3.969009067064554*^9}, {3.969010627086128*^9, 
  3.9690106508441067`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[484]:=",ExpressionUUID->"69954569-88e6-8b4a-9d99-7647568609aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<thresholds.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<flows.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<thresholds.csv\>\"", ",", " ", "c"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<flows.csv\>\"", ",", " ", "f"}], "]"}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9690100015800037`*^9, 3.9690100396365986`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[411]:=",ExpressionUUID->"5a72cde6-a05b-4748-ae24-08b0e390ffac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prepare data for mathematica sim", "Subsection",
 CellChangeTimes->{{3.9693536769156933`*^9, 3.969353677724695*^9}, {
  3.9694407639601974`*^9, 
  3.9694407798812485`*^9}},ExpressionUUID->"5d5e269c-d4be-0943-ade6-\
7ebaea7eb871"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-naive.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w", ",", " ", "1"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<rate-list.mx\>\"", ",", " ", "rateList"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list.mx\>\"", ",", " ", "linkList"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.969353462859173*^9, 3.9693535218972015`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"44e441b8-0139-e24c-b864-2f59c3e8c758"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"rateList\\\", \\\",\\\", \
\\\"linkList\\\"}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"ComputeCumRatesAndLinks\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"FetchData\\\", \\\"[\\\", \\\"\\\\\\\"g.mx\\\\\\\"\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"FetchData\\\", \\\"[\\\", \\\"\\\\\\\"w-naive.mx\\\\\\\
\"\\\", \\\"]\\\"}], \\\",\\\", \\\"1\\\"}], \\\"]\\\"}]\\) are not the same \
shape.\"", 2, 3, 1, 27101679041734980243, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.969960725717581*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"66ce04e8-825c-2d4a-9e08-bd39b93a9f5e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-speed.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w", ",", " ", "1"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<rate-list-speed.mx\>\"", ",", " ", "rateList"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list.mx\>\"", ",", " ", "linkList"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.969353462859173*^9, 3.9693534943591404`*^9}, {
  3.9693535251662083`*^9, 3.969353533288374*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"c296e610-5394-ab4e-aab4-f1c67b022e76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-time-morning.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w", ",", " ", "1"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<rate-list-time-morning.mx\>\"", ",", " ", "rateList"}], "]"}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list.mx\>\"", ",", " ", "linkList"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.969353462859173*^9, 3.9693534955391865`*^9}, {
  3.9693535368912125`*^9, 3.969353538951702*^9}, {3.9693562782048607`*^9, 
  3.9693562834418583`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"a4c01c54-5138-dc43-a525-b3388c0ce0a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<g.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<w-time-evening.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"ComputeCumRatesAndLinks", "[", 
     RowBox[{"g", ",", " ", "w", ",", " ", "1"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<rate-list-time-evening.mx\>\"", ",", " ", "rateList"}], "]"}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<link-list.mx\>\"", ",", " ", "linkList"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.969353462859173*^9, 3.9693534955391865`*^9}, {
  3.9693535368912125`*^9, 3.969353538951702*^9}, {3.9693562782048607`*^9, 
  3.969356291117859*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"ae70b1a8-e63a-834a-86c9-57e174c3522a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiple node sim", "Section",
 CellChangeTimes->{{3.969347940175701*^9, 
  3.969347944973692*^9}},ExpressionUUID->"f6fbdc82-12a3-d349-b94e-\
342f3238932d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<SimulateMulti\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateMulti", "[", 
    RowBox[{
    "cumulativeRates_", ",", " ", "linkList_", ",", " ", "thresh_", ",", " ", 
     "nodeFlows_", ",", "  ", "nAgents_", ",", " ", "maxSteps_", ",", " ", 
     RowBox[{"nVaccines_", " ", ":", " ", "0"}]}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nNodes", ",", " ", "t", ",", " ", "ExecuteNode", ",", " ", 
       "nodeOccupancies", ",", " ", "nodeThresholds"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nodeThresholds", " ", "=", " ", "thresh"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nNodes", " ", "=", " ", 
       RowBox[{"Length", "[", "cumulativeRates", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nNodes", " ", "!=", " ", 
         RowBox[{"Length", "[", "nodeThresholds", "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nNodes", " ", "!=", " ", 
         RowBox[{"Length", "[", "nodeFlows", "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", "nVaccines"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "node", ",", " ", "choice", ",", " ", "linkId", ",", " ", 
            "destNode"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"node", " ", "=", " ", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "nNodes"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"choice", " ", "=", " ", 
            RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"linkId", " ", "=", 
            RowBox[{"SelectFirst", "[", 
             RowBox[{
              RowBox[{"cumulativeRates", "[", 
               RowBox[{"[", "node", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"choice", " ", "<=", " ", "#"}], "&"}], " ", "->", 
               " ", "\"\<Index\>\""}], ",", " ", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Assert", "[", 
            RowBox[{"linkId", " ", "!=", " ", 
             RowBox[{"-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"destNode", " ", "=", " ", 
            RowBox[{"linkList", "[", 
             RowBox[{"[", 
              RowBox[{"node", ",", " ", "linkId"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nodeThresholds", "[", 
             RowBox[{"[", "destNode", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"+", "Infinity"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nodeOccupancies", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"GenerateOccupanciesUniform", "[", 
         RowBox[{"nAgents", ",", " ", "nNodes"}], "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExecuteNode", " ", "[", 
        RowBox[{"nodeId_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "maxCarsToMove", ",", " ", "carsInNode", ",", " ", "carsToMove", ",",
            " ", "choices", ",", " ", "links"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxCarsToMove", " ", "=", " ", 
           RowBox[{"nodeFlows", "[", 
            RowBox[{"[", "nodeId", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"carsInNode", " ", "=", " ", 
           RowBox[{"nodeOccupancies", "[", 
            RowBox[{"[", 
             RowBox[{"t", ",", " ", "nodeId"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"choices", " ", "=", " ", 
           RowBox[{"cumulativeRates", "[", 
            RowBox[{"[", "nodeId", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"links", " ", "=", " ", 
           RowBox[{"linkList", "[", 
            RowBox[{"[", "nodeId", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"carsToMove", " ", "=", " ", 
           RowBox[{"Floor", "@", 
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"carsInNode", ",", " ", "maxCarsToMove"}], "}"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "ParallelDo", " ", "here", " ", "slows", " ", "down", " ", "by", " ",
             "a", " ", "lot", " ", "due", " ", "to", " ", "memory", " ", 
            "overhead", " ", "sigh"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"choice", ",", " ", "linkId", ",", " ", "destNode"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"choice", " ", "=", " ", 
                RowBox[{"RandomReal", "[", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"linkId", " ", "=", 
                RowBox[{"SelectFirst", "[", 
                 RowBox[{"choices", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"choice", " ", "<=", " ", "#"}], "&"}], " ", "->",
                    " ", "\"\<Index\>\""}], ",", " ", 
                  RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Assert", "[", 
                RowBox[{"linkId", " ", "!=", " ", 
                 RowBox[{"-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"destNode", " ", "=", " ", 
                RowBox[{"links", "[", 
                 RowBox[{"[", "linkId", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nodeThresholds", "[", 
                   RowBox[{"[", "destNode", "]"}], "]"}], " ", ">=", " ", 
                  RowBox[{"nodeOccupancies", "[", 
                   RowBox[{"[", 
                    RowBox[{"t", ",", " ", "destNode"}], "]"}], "]"}]}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nodeOccupancies", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", " ", "destNode"}], "]"}], 
                    "]"}], "++"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"nodeOccupancies", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", " ", "nodeId"}], "]"}], 
                    "]"}], "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
            "carsToMove"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"t", "=", "1"}], ",", " ", 
        RowBox[{"t", "<=", "maxSteps"}], ",", "  ", 
        RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"nodeOccupancies", ",", " ", 
           RowBox[{"nodeOccupancies", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"ExecuteNode", "[", 
            RowBox[{"i", ",", " ", "t"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "nNodes"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Assert", "[", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"nodeOccupancies", "[", "t", "]"}], " ", "==", " ", 
            "nAgents"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "nodeOccupancies"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693481296963673`*^9, 3.9693481859183483`*^9}, {
   3.969348232270075*^9, 3.969348656148094*^9}, {3.969348739126812*^9, 
   3.9693487425047607`*^9}, {3.969348972026552*^9, 3.969349127882431*^9}, {
   3.9693491668534126`*^9, 3.969349197577818*^9}, {3.9693493081512985`*^9, 
   3.969349555940176*^9}, {3.969349592916069*^9, 3.9693496155321465`*^9}, {
   3.969349697814108*^9, 3.96934970382329*^9}, 3.969350188246067*^9, {
   3.969352081816538*^9, 3.969352086139059*^9}, {3.9693522151776505`*^9, 
   3.969352216079872*^9}, {3.9693522579718685`*^9, 3.9693522586578693`*^9}, {
   3.96935230279484*^9, 3.969352304146883*^9}, {3.969352503441883*^9, 
   3.969352521479885*^9}, {3.9694386347033024`*^9, 3.969438714289364*^9}, 
   3.9694648858803196`*^9, {3.969965104044552*^9, 3.969965202133274*^9}, {
   3.969965276065523*^9, 3.969965276366167*^9}, {3.969965352702406*^9, 
   3.969965435028183*^9}, {3.970034033040243*^9, 3.97003403494261*^9}, {
   3.971375665256052*^9, 3.9713756666706333`*^9}},
 Background->RGBColor[
  0.8, 0.3, 0.8, 0.33],ExpressionUUID->"cf6aee44-a54b-6346-bfc9-97b3224c00dc"],

Cell[CellGroupData[{

Cell["Simulations", "Subsection",
 CellChangeTimes->{{3.9694407544270782`*^9, 
  3.969440755503414*^9}},ExpressionUUID->"58662d84-36a4-a84c-9230-\
fe69d04e9e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<thresholds.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<flows.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", "20000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"Length", "@", "c"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sampleCount", " ", "=", " ", "20"}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9694409162757225`*^9, 3.969440943519476*^9}, {
   3.9694683324453506`*^9, 3.96946834107201*^9}, {3.96996075699613*^9, 
   3.969960758029951*^9}, {3.969960842602951*^9, 3.969960843506386*^9}, 
   3.969960986189211*^9, {3.969961274831276*^9, 3.969961275288643*^9}, {
   3.96996143101038*^9, 3.9699614311532135`*^9}, {3.9699614649549656`*^9, 
   3.9699614653407383`*^9}, {3.969961925239685*^9, 3.96996192561915*^9}, {
   3.969962223551523*^9, 3.96996222385063*^9}, {3.969962476136318*^9, 
   3.969962477670616*^9}, {3.970033634342806*^9, 3.97003363581168*^9}},
 Background->GrayLevel[0.85],
 CellLabel->"In[70]:=",ExpressionUUID->"d6f7aa41-6a3a-6047-a952-387b66a8a283"],

Cell[CellGroupData[{

Cell["Null model", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 
  3.969440788155443*^9}},ExpressionUUID->"5f33e214-081a-b344-a7b7-\
dde9b886598c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GenerateOccupanciesUniform", "[", 
      RowBox[{"n", ",", " ", "M"}], "]"}], " ", ",", "sampleCount"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<results-null.mx\>\"", ",", " ", "results"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9694408100059147`*^9, 3.9694408115221214`*^9}, {
  3.969440886943075*^9, 3.9694409054967575`*^9}, {3.9694409488546066`*^9, 
  3.9694409695039062`*^9}, {3.9713755351263313`*^9, 3.971375538217266*^9}},
 Background->RGBColor[0.14, 0.8, 0.14, 0.33],
 CellLabel->
  "In[125]:=",ExpressionUUID->"80bc644c-ac11-9949-aebf-bd41597109e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Naive", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 3.96944079524366*^9}, {
  3.9694426399237213`*^9, 
  3.9694426400807247`*^9}},ExpressionUUID->"ca93fd57-311f-a747-9ebb-\
fd8ec75ff6d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FetchData", "[", "\"\<rate-list.mx\>\"", "]"}], ",", " ", 
      RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"results", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"SimulateMulti", "[", 
        RowBox[{
        "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
         " ", "n", ",", " ", "t"}], "]"}]}], ",", " ", "sampleCount", ",", 
      " ", 
      RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<results-naive.mx\>\"", ",", " ", "results"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693480929383297`*^9, 3.969348107639433*^9}, 
   3.969349228036974*^9, {3.969349943825371*^9, 3.9693499568430157`*^9}, {
   3.969351890227812*^9, 3.969351917190817*^9}, {3.9693528355969906`*^9, 
   3.9693528518959904`*^9}, 3.969353208506069*^9, {3.9693533827761517`*^9, 
   3.9693533834261055`*^9}, 3.9693534521161346`*^9, {3.969373860696623*^9, 
   3.9693739107467976`*^9}, {3.969374215783453*^9, 3.96937421616148*^9}, {
   3.9694387347641945`*^9, 3.969438780348583*^9}, 3.969438863752371*^9, {
   3.9694396558016167`*^9, 3.9694396686424046`*^9}, {3.969439980857626*^9, 
   3.969439981111126*^9}, {3.9694409150396614`*^9, 3.969440918050436*^9}, 
   3.9694409640126057`*^9, {3.9694413430692577`*^9, 3.969441381134424*^9}, {
   3.9694415669489574`*^9, 3.969441603495615*^9}, {3.9713755214576874`*^9, 
   3.971375530741724*^9}, {3.9713762959785557`*^9, 3.971376296937193*^9}},
 Background->RGBColor[0.14, 0.8, 0.14, 0.33],
 CellLabel->
  "In[127]:=",ExpressionUUID->"61d20228-fb2b-8a46-a632-872e04206e6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Speed", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 3.96944079524366*^9}, {
  3.969442617990818*^9, 3.9694426188454895`*^9}, {3.9694426769828815`*^9, 
  3.969442677107958*^9}},ExpressionUUID->"2933cafb-3861-f748-badb-\
161f8cd4ed82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FetchData", "[", "\"\<rate-list-speed.mx\>\"", "]"}], ",", " ", 
      RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"results", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"SimulateMulti", "[", 
        RowBox[{
        "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
         " ", "n", ",", " ", "t"}], "]"}]}], ",", " ", "sampleCount", ",", 
      " ", 
      RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<results-speed.mx\>\"", ",", " ", "results"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693480929383297`*^9, 3.969348107639433*^9}, 
   3.969349228036974*^9, {3.969349943825371*^9, 3.9693499568430157`*^9}, {
   3.969351890227812*^9, 3.969351917190817*^9}, {3.9693528355969906`*^9, 
   3.9693528518959904`*^9}, 3.969353208506069*^9, {3.9693533827761517`*^9, 
   3.9693533834261055`*^9}, 3.9693534521161346`*^9, {3.969373860696623*^9, 
   3.9693739107467976`*^9}, {3.969374215783453*^9, 3.96937421616148*^9}, {
   3.9694387347641945`*^9, 3.969438780348583*^9}, 3.969438863752371*^9, {
   3.9694396558016167`*^9, 3.9694396686424046`*^9}, {3.969439980857626*^9, 
   3.969439981111126*^9}, {3.9694409150396614`*^9, 3.969440918050436*^9}, 
   3.9694409640126057`*^9, {3.9694413430692577`*^9, 3.969441381134424*^9}, {
   3.9694415669489574`*^9, 3.969441603495615*^9}, {3.9694426505571423`*^9, 
   3.9694426578014584`*^9}, {3.971375512985428*^9, 3.9713755185449543`*^9}, {
   3.9713762926784153`*^9, 3.9713762935580025`*^9}},
 Background->RGBColor[
  0.14, 0.8, 0.14, 
   0.33],ExpressionUUID->"7257d6ab-94d2-b842-8079-046fa19e5f9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time morning", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 3.96944079524366*^9}, {
  3.969442617990818*^9, 3.9694426188454895`*^9}, {3.969442673258995*^9, 
  3.969442674406576*^9}},ExpressionUUID->"60eb5ae1-3fcf-fa48-aa4b-\
6fe82805991a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FetchData", "[", "\"\<rate-list-time-morning.mx\>\"", "]"}], ",",
       " ", 
      RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"results", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"SimulateMulti", "[", 
        RowBox[{
        "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
         " ", "n", ",", " ", "t"}], "]"}]}], ",", " ", "sampleCount", ",", 
      " ", 
      RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<results-time-morning.mx\>\"", ",", " ", "results"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693480929383297`*^9, 3.969348107639433*^9}, 
   3.969349228036974*^9, {3.969349943825371*^9, 3.9693499568430157`*^9}, {
   3.969351890227812*^9, 3.969351917190817*^9}, {3.9693528355969906`*^9, 
   3.9693528518959904`*^9}, 3.969353208506069*^9, {3.9693533827761517`*^9, 
   3.9693533834261055`*^9}, 3.9693534521161346`*^9, {3.969373860696623*^9, 
   3.9693739107467976`*^9}, {3.969374215783453*^9, 3.96937421616148*^9}, {
   3.9694387347641945`*^9, 3.969438780348583*^9}, 3.969438863752371*^9, {
   3.9694396558016167`*^9, 3.9694396686424046`*^9}, {3.969439980857626*^9, 
   3.969439981111126*^9}, {3.9694409150396614`*^9, 3.969440918050436*^9}, 
   3.9694409640126057`*^9, {3.9694413430692577`*^9, 3.969441381134424*^9}, {
   3.9694415669489574`*^9, 3.969441603495615*^9}, {3.9694426505571423`*^9, 
   3.9694426865853577`*^9}, {3.9699607698939266`*^9, 3.9699607707194805`*^9}, 
   3.9699609827658195`*^9, {3.9699612678185863`*^9, 3.9699612682785645`*^9}, {
   3.9699614271606007`*^9, 3.9699614273027687`*^9}, {3.96996147114192*^9, 
   3.9699614712522144`*^9}, {3.969961920110304*^9, 3.969961922350151*^9}, {
   3.969962219591131*^9, 3.969962220270754*^9}, {3.969962470442831*^9, 
   3.9699624718996983`*^9}, {3.970033628671667*^9, 3.970033629553486*^9}, {
   3.971375484939945*^9, 3.971375508017601*^9}, {3.971375566377859*^9, 
   3.971375566551111*^9}, {3.9713762885930843`*^9, 3.971376289935316*^9}},
 Background->RGBColor[
  0.14, 0.8, 0.14, 
   0.33],ExpressionUUID->"b83b1d54-8f4b-9947-99f9-2d1114503f4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time evening", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 3.96944079524366*^9}, {
  3.969442617990818*^9, 3.9694426188454895`*^9}, {3.969442673258995*^9, 
  3.969442674406576*^9}, {3.969442714252716*^9, 
  3.9694427152894382`*^9}},ExpressionUUID->"a0ad1ec9-da6c-a841-8a75-\
249dee816538"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FetchData", "[", "\"\<rate-list-time-evening.mx\>\"", "]"}], ",",
       " ", 
      RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"results", " ", "=", " ", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"SimulateMulti", "[", 
        RowBox[{
        "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
         " ", "n", ",", " ", "t"}], "]"}]}], ",", " ", "sampleCount", ",", 
      " ", 
      RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExportData", "[", 
   RowBox[{"\"\<results-time-evening.mx\>\"", ",", " ", "results"}], "]"}], 
  ";"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693480929383297`*^9, 3.969348107639433*^9}, 
   3.969349228036974*^9, {3.969349943825371*^9, 3.9693499568430157`*^9}, {
   3.969351890227812*^9, 3.969351917190817*^9}, {3.9693528355969906`*^9, 
   3.9693528518959904`*^9}, 3.969353208506069*^9, {3.9693533827761517`*^9, 
   3.9693533834261055`*^9}, 3.9693534521161346`*^9, {3.969373860696623*^9, 
   3.9693739107467976`*^9}, {3.969374215783453*^9, 3.96937421616148*^9}, {
   3.9694387347641945`*^9, 3.969438780348583*^9}, 3.969438863752371*^9, {
   3.9694396558016167`*^9, 3.9694396686424046`*^9}, {3.969439980857626*^9, 
   3.969439981111126*^9}, {3.9694409150396614`*^9, 3.969440918050436*^9}, 
   3.9694409640126057`*^9, {3.9694413430692577`*^9, 3.969441381134424*^9}, {
   3.9694415669489574`*^9, 3.969441603495615*^9}, {3.9694426505571423`*^9, 
   3.9694426865853577`*^9}, {3.9694427177577076`*^9, 
   3.9694427188580112`*^9}, {3.971375470864277*^9, 3.971375481247299*^9}, {
   3.97137630157325*^9, 3.971376302925005*^9}},
 Background->RGBColor[0.14, 0.8, 0.14, 0.33],
 CellLabel->
  "In[155]:=",ExpressionUUID->"830a25de-2f54-5a4d-8973-47d68770032e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Avalanche size", "Section",
 CellChangeTimes->{{3.9694692919797688`*^9, 
  3.969469294169012*^9}},ExpressionUUID->"01561d2d-a773-7e4e-86fa-\
fb048a77985a"],

Cell["\<\
TODO copia computeAvalancheSize dal vecchia versione del notebook, usa \
simulazione multi per controllare la distribuzione. A ogni timestep controlla \
se ci sono valanghe e propagale ezs\
\>", "Text",
 CellChangeTimes->{{3.9694692979402504`*^9, 
  3.969469324674776*^9}},ExpressionUUID->"bac24293-f12a-3348-9450-\
15b07ba3d66a"],

Cell[CellGroupData[{

Cell["Time morning bracketed", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 3.96944079524366*^9}, {
  3.969442617990818*^9, 3.9694426188454895`*^9}, {3.969442673258995*^9, 
  3.969442674406576*^9}, {3.971355035139761*^9, 
  3.9713550378028507`*^9}},ExpressionUUID->"5593a267-c74a-794a-b682-\
e38c07bb45bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<thresholds.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<flows.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"M", " ", "=", " ", 
     RowBox[{"Length", "@", "c"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"t", " ", "=", " ", "25"}], ";", "\[IndentingNewLine]", 
    RowBox[{"sampleCount", " ", "=", " ", "10"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FetchData", "[", "\"\<rate-list-time-morning.mx\>\"", "]"}], ",",
        " ", 
       RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"results", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"SimulateMulti", "[", 
         RowBox[{
         "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
          " ", "n", ",", " ", "t"}], "]"}]}], ",", " ", "sampleCount", ",", 
       " ", 
       RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ExportData", "[", 
     RowBox[{
      RowBox[{"\"\<results-time-morning-\>\"", "<>", 
       RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.mx\>\""}], ",", " ", 
      "results"}], "]"}], ";"}], "\[IndentingNewLine]", ",", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "4000", ",", " ", "32000", ",", " ", "4000"}], 
    "}"}]}], "]"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693480929383297`*^9, 3.969348107639433*^9}, 
   3.969349228036974*^9, {3.969349943825371*^9, 3.9693499568430157`*^9}, {
   3.969351890227812*^9, 3.969351917190817*^9}, {3.9693528355969906`*^9, 
   3.9693528518959904`*^9}, 3.969353208506069*^9, {3.9693533827761517`*^9, 
   3.9693533834261055`*^9}, 3.9693534521161346`*^9, {3.969373860696623*^9, 
   3.9693739107467976`*^9}, {3.969374215783453*^9, 3.96937421616148*^9}, {
   3.9694387347641945`*^9, 3.969438780348583*^9}, 3.969438863752371*^9, {
   3.9694396558016167`*^9, 3.9694396686424046`*^9}, {3.969439980857626*^9, 
   3.969439981111126*^9}, {3.9694409150396614`*^9, 3.969440918050436*^9}, 
   3.9694409640126057`*^9, {3.9694413430692577`*^9, 3.969441381134424*^9}, {
   3.9694415669489574`*^9, 3.969441603495615*^9}, {3.9694426505571423`*^9, 
   3.9694426865853577`*^9}, {3.9699607698939266`*^9, 3.9699607707194805`*^9}, 
   3.9699609827658195`*^9, {3.9699612678185863`*^9, 3.9699612682785645`*^9}, {
   3.9699614271606007`*^9, 3.9699614273027687`*^9}, {3.96996147114192*^9, 
   3.9699614712522144`*^9}, {3.969961920110304*^9, 3.969961922350151*^9}, {
   3.969962219591131*^9, 3.969962220270754*^9}, {3.969962470442831*^9, 
   3.9699624718996983`*^9}, {3.970033628671667*^9, 3.970033629553486*^9}, {
   3.9713550586600056`*^9, 3.9713551166476345`*^9}, {3.971355325473406*^9, 
   3.9713553282313976`*^9}, {3.971518410239517*^9, 3.971518412956949*^9}},
 Background->RGBColor[
  0.14, 0.8, 0.14, 
   0.33],ExpressionUUID->"feac1d2e-16a0-fc4f-884d-9b868c04e6ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time morning with immunization bracketed", "Subsubsection",
 CellChangeTimes->{{3.9694407865220146`*^9, 3.96944079524366*^9}, {
  3.969442617990818*^9, 3.9694426188454895`*^9}, {3.969442673258995*^9, 
  3.969442674406576*^9}, {3.969964400222517*^9, 3.9699644022535725`*^9}, {
  3.971375579956993*^9, 
  3.971375581655485*^9}},ExpressionUUID->"700b174a-e0f4-9e40-bd05-\
7f02cd71e586"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<thresholds.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<flows.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"M", " ", "=", " ", 
     RowBox[{"Length", "@", "c"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"t", " ", "=", " ", "25"}], ";", "\[IndentingNewLine]", 
    RowBox[{"sampleCount", " ", "=", " ", "10"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FetchData", "[", "\"\<rate-list-time-morning.mx\>\"", "]"}], ",",
        " ", 
       RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"results", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"SimulateMulti", "[", 
         RowBox[{
         "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
          " ", "n", ",", " ", "t", ",", " ", "900"}], "]"}]}], ",", " ", 
       "sampleCount", ",", " ", 
       RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ExportData", "[", 
     RowBox[{
      RowBox[{"\"\<results-time-morning-immunized-900-\>\"", "<>", 
       RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.mx\>\""}], ",", " ", 
      "results"}], "]"}], ";"}], "\[IndentingNewLine]", ",", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "4000", ",", " ", "32000", ",", " ", "4000"}], 
    "}"}]}], "]"}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693480929383297`*^9, 3.969348107639433*^9}, 
   3.969349228036974*^9, {3.969349943825371*^9, 3.9693499568430157`*^9}, {
   3.969351890227812*^9, 3.969351917190817*^9}, {3.9693528355969906`*^9, 
   3.9693528518959904`*^9}, 3.969353208506069*^9, {3.9693533827761517`*^9, 
   3.9693533834261055`*^9}, 3.9693534521161346`*^9, {3.969373860696623*^9, 
   3.9693739107467976`*^9}, {3.969374215783453*^9, 3.96937421616148*^9}, {
   3.9694387347641945`*^9, 3.969438780348583*^9}, 3.969438863752371*^9, {
   3.9694396558016167`*^9, 3.9694396686424046`*^9}, {3.969439980857626*^9, 
   3.969439981111126*^9}, {3.9694409150396614`*^9, 3.969440918050436*^9}, 
   3.9694409640126057`*^9, {3.9694413430692577`*^9, 3.969441381134424*^9}, {
   3.9694415669489574`*^9, 3.969441603495615*^9}, {3.9694426505571423`*^9, 
   3.9694426865853577`*^9}, {3.9699607698939266`*^9, 3.9699607707194805`*^9}, 
   3.9699609827658195`*^9, {3.9699612678185863`*^9, 3.9699612682785645`*^9}, {
   3.9699614271606007`*^9, 3.9699614273027687`*^9}, {3.96996147114192*^9, 
   3.9699614712522144`*^9}, {3.969961920110304*^9, 3.969961922350151*^9}, {
   3.969962219591131*^9, 3.969962220270754*^9}, {3.969962470442831*^9, 
   3.9699624718996983`*^9}, {3.970033628671667*^9, 3.970033629553486*^9}, {
   3.9713550586600056`*^9, 3.9713551166476345`*^9}, {3.971355325473406*^9, 
   3.9713553282313976`*^9}, {3.9713756350183697`*^9, 3.971375645660469*^9}, {
   3.9713774597250195`*^9, 3.971377462979269*^9}, {3.971377510185957*^9, 
   3.971377512877714*^9}, {3.9713775489766293`*^9, 3.971377549997881*^9}},
 Background->RGBColor[
  0.14, 0.8, 0.14, 
   0.33],ExpressionUUID->"eb117506-326a-954d-bc35-a47b2069c395"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Immunization 2 ", "Section",
 CellChangeTimes->{{3.969347940175701*^9, 3.969347944973692*^9}, {
  3.9715180577673836`*^9, 
  3.9715180672773895`*^9}},ExpressionUUID->"6fed0b4c-c817-0041-a636-\
9f9aeee641cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<SimulateMulti\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulateMulti", "[", 
    RowBox[{
    "cumulativeRates_", ",", " ", "linkList_", ",", " ", "thresh_", ",", " ", 
     "nodeFlows_", ",", "  ", "nAgents_", ",", " ", "maxSteps_", ",", " ", 
     RowBox[{"nVaccines_", " ", ":", " ", "0"}]}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nNodes", ",", " ", "t", ",", " ", "ExecuteNode", ",", " ", 
       "nodeOccupancies", ",", " ", "nodeThresholds"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nodeThresholds", " ", "=", " ", "thresh"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nNodes", " ", "=", " ", 
       RowBox[{"Length", "[", "cumulativeRates", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nNodes", " ", "!=", " ", 
         RowBox[{"Length", "[", "nodeThresholds", "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nNodes", " ", "!=", " ", 
         RowBox[{"Length", "[", "nodeFlows", "]"}]}], ",", " ", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", "nVaccines"}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "node", ",", " ", "choice", ",", " ", "linkId", ",", " ", 
            "destNode"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"node", " ", "=", " ", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "nNodes"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"choice", " ", "=", " ", 
            RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"linkId", " ", "=", 
            RowBox[{"SelectFirst", "[", 
             RowBox[{
              RowBox[{"cumulativeRates", "[", 
               RowBox[{"[", "node", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"choice", " ", "<=", " ", "#"}], "&"}], " ", "->", 
               " ", "\"\<Index\>\""}], ",", " ", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Assert", "[", 
            RowBox[{"linkId", " ", "!=", " ", 
             RowBox[{"-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"destNode", " ", "=", " ", 
            RowBox[{"linkList", "[", 
             RowBox[{"[", 
              RowBox[{"node", ",", " ", "linkId"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nodeThresholds", "[", 
             RowBox[{"[", "destNode", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"+", "Infinity"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nodeOccupancies", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"GenerateOccupanciesUniform", "[", 
         RowBox[{"nAgents", ",", " ", "nNodes"}], "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExecuteNode", " ", "[", 
        RowBox[{"nodeId_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "maxCarsToMove", ",", " ", "carsInNode", ",", " ", "carsToMove", ",",
            " ", "choices", ",", " ", "links"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxCarsToMove", " ", "=", " ", 
           RowBox[{"nodeFlows", "[", 
            RowBox[{"[", "nodeId", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"carsInNode", " ", "=", " ", 
           RowBox[{"nodeOccupancies", "[", 
            RowBox[{"[", 
             RowBox[{"t", ",", " ", "nodeId"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"carsInNode", " ", ">", " ", 
             RowBox[{"thresholds", "[", 
              RowBox[{"[", "nodeId", "]"}], "]"}]}], ",", " ", 
            RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"choices", " ", "=", " ", 
           RowBox[{"cumulativeRates", "[", 
            RowBox[{"[", "nodeId", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"links", " ", "=", " ", 
           RowBox[{"linkList", "[", 
            RowBox[{"[", "nodeId", "]"}], "]"}]}], ";", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"carsToMove", " ", "=", " ", 
           RowBox[{"Floor", "@", 
            RowBox[{"Min", "[", 
             RowBox[{"{", 
              RowBox[{"carsInNode", ",", " ", "maxCarsToMove"}], "}"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "ParallelDo", " ", "here", " ", "slows", " ", "down", " ", "by", " ",
             "a", " ", "lot", " ", "due", " ", "to", " ", "memory", " ", 
            "overhead", " ", "sigh"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"choice", ",", " ", "linkId", ",", " ", "destNode"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"choice", " ", "=", " ", 
                RowBox[{"RandomReal", "[", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"linkId", " ", "=", 
                RowBox[{"SelectFirst", "[", 
                 RowBox[{"choices", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"choice", " ", "<=", " ", "#"}], "&"}], " ", "->",
                    " ", "\"\<Index\>\""}], ",", " ", 
                  RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Assert", "[", 
                RowBox[{"linkId", " ", "!=", " ", 
                 RowBox[{"-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"destNode", " ", "=", " ", 
                RowBox[{"links", "[", 
                 RowBox[{"[", "linkId", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nodeThresholds", "[", 
                   RowBox[{"[", "destNode", "]"}], "]"}], " ", ">=", " ", 
                  RowBox[{"nodeOccupancies", "[", 
                   RowBox[{"[", 
                    RowBox[{"t", ",", " ", "destNode"}], "]"}], "]"}]}], ",", 
                 " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"nodeOccupancies", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", " ", "destNode"}], "]"}], 
                    "]"}], "++"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"nodeOccupancies", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", " ", "nodeId"}], "]"}], 
                    "]"}], "--"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ",", " ", 
            "carsToMove"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"t", "=", "1"}], ",", " ", 
        RowBox[{"t", "<=", "maxSteps"}], ",", "  ", 
        RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"nodeOccupancies", ",", " ", 
           RowBox[{"nodeOccupancies", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"ExecuteNode", "[", 
            RowBox[{"i", ",", " ", "t"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "1", ",", " ", "nNodes"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Assert", "[", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"nodeOccupancies", "[", "t", "]"}], " ", "==", " ", 
            "nAgents"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "nodeOccupancies"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9693481296963673`*^9, 3.9693481859183483`*^9}, {
   3.969348232270075*^9, 3.969348656148094*^9}, {3.969348739126812*^9, 
   3.9693487425047607`*^9}, {3.969348972026552*^9, 3.969349127882431*^9}, {
   3.9693491668534126`*^9, 3.969349197577818*^9}, {3.9693493081512985`*^9, 
   3.969349555940176*^9}, {3.969349592916069*^9, 3.9693496155321465`*^9}, {
   3.969349697814108*^9, 3.96934970382329*^9}, 3.969350188246067*^9, {
   3.969352081816538*^9, 3.969352086139059*^9}, {3.9693522151776505`*^9, 
   3.969352216079872*^9}, {3.9693522579718685`*^9, 3.9693522586578693`*^9}, {
   3.96935230279484*^9, 3.969352304146883*^9}, {3.969352503441883*^9, 
   3.969352521479885*^9}, {3.9694386347033024`*^9, 3.969438714289364*^9}, 
   3.9694648858803196`*^9, {3.969965104044552*^9, 3.969965202133274*^9}, {
   3.969965276065523*^9, 3.969965276366167*^9}, {3.969965352702406*^9, 
   3.969965435028183*^9}, {3.970034033040243*^9, 3.97003403494261*^9}, {
   3.971375665256052*^9, 3.9713756666706333`*^9}, {3.9715182566608696`*^9, 
   3.971518286127899*^9}},
 Background->RGBColor[
  0.8, 0.3, 0.8, 0.33],ExpressionUUID->"99d35d54-a708-c042-b51a-cd759e9909be"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"FetchData", "[", "\"\<thresholds.mx\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{"FetchData", "[", "\"\<flows.mx\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"Length", "@", "c"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sampleCount", " ", "=", " ", "20"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rateList", ",", " ", "linkList"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FetchData", "[", "\"\<rate-list-time-morning.mx\>\"", "]"}], ",",
       " ", 
      RowBox[{"FetchData", "[", "\"\<link-list.mx\>\"", "]"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"SimulateMulti", "[", 
       RowBox[{
       "rateList", ",", " ", "linkList", ",", " ", "c", ",", " ", "f", ",", 
        " ", "n", ",", " ", "t"}], "]"}]}], ",", " ", "sampleCount", ",", " ", 
     RowBox[{"Method", "->", "\"\<FinestGrained\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"stedNodeCountImm", " ", "=", " ", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"res", "[", 
         RowBox[{"[", "x", "]"}], "]"}], " ", "-", " ", "thresholds"}], ",", 
       " ", 
       RowBox[{"a_", " ", "/;", 
        RowBox[{"a", ">", "0"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "@", "res"}]}], "}"}]}], "]"}], "  ", "/", "M", 
   "\[IndentingNewLine]"}]}]}], "Input",
 CellChangeTimes->{{3.9715183084708347`*^9, 3.971518428479433*^9}, 
   3.971518593019968*^9},
 CellLabel->
  "In[387]:=",ExpressionUUID->"ffaa09c9-98b6-3045-a2d3-97c1e201ce23"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["33", "263"], ",", 
   FractionBox["163", "1315"], ",", 
   FractionBox["1152", "9205"], ",", 
   FractionBox["63", "526"], ",", 
   FractionBox["230", "1841"], ",", 
   FractionBox["2357", "18410"], ",", 
   FractionBox["1152", "9205"], ",", 
   FractionBox["226", "1841"], ",", 
   FractionBox["1159", "9205"], ",", 
   FractionBox["227", "1841"], ",", 
   FractionBox["162", "1315"], ",", 
   FractionBox["467", "3682"], ",", 
   FractionBox["230", "1841"], ",", 
   FractionBox["2267", "18410"], ",", 
   FractionBox["233", "1841"], ",", 
   FractionBox["2307", "18410"], ",", 
   FractionBox["168", "1315"], ",", 
   FractionBox["2369", "18410"], ",", 
   FractionBox["2311", "18410"], ",", 
   FractionBox["2341", "18410"]}], "}"}]], "Output",
 CellChangeTimes->{3.971518576430622*^9},
 CellLabel->
  "Out[394]=",ExpressionUUID->"d1cc408d-be1a-634e-aa2e-b6b16a226f50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Mean", "@", "stedNodeCountImm"}], " ", "//", "N"}]], "Input",
 CellChangeTimes->{{3.9715185960104218`*^9, 3.9715186044917393`*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"81103101-d667-364b-9cba-729d9ee057f6"],

Cell[BoxData["0.12517653449212385`"], "Output",
 CellChangeTimes->{{3.971518598177908*^9, 3.971518605117275*^9}},
 CellLabel->
  "Out[396]=",ExpressionUUID->"aaf2a1ba-98e7-2645-a538-ce2c58e90eef"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 752.25},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
FrontEndVersion->"14.3 for Microsoft Windows (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8240bcfd-4a36-6c48-8602-7051a02a8617"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 1287, 28, 63, "Input",ExpressionUUID->"939ec6e9-c18f-b54a-912f-9e3e54efb049"],
Cell[CellGroupData[{
Cell[1866, 52, 161, 3, 66, "Section",ExpressionUUID->"39dbf734-9b61-6c48-896c-6e59dc3fd660"],
Cell[2030, 57, 1778, 45, 234, "Input",ExpressionUUID->"49fe4d56-4856-6d40-8724-431297aa339e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3845, 107, 179, 3, 66, "Section",ExpressionUUID->"f37dac47-54e5-d647-866c-8bbf1483fcc0"],
Cell[4027, 112, 8317, 164, 843, "Input",ExpressionUUID->"fc9e5a63-85df-254b-843a-04c92844d549"],
Cell[CellGroupData[{
Cell[12369, 280, 276, 4, 53, "Subsection",ExpressionUUID->"e117ba6d-e4cb-ac4a-8cc0-b079dc32f9a9"],
Cell[12648, 286, 1698, 42, 234, "Input",ExpressionUUID->"42f879a4-ebe2-4c4c-b095-b0da5f5bf603"],
Cell[14349, 330, 1534, 40, 234, "Input",ExpressionUUID->"4bc5b48b-8fd4-d147-8fc6-a146ab065cfd"],
Cell[15886, 372, 1693, 42, 234, "Input",ExpressionUUID->"bdf3479a-fddc-9446-a928-fac2672b0903"],
Cell[17582, 416, 1645, 42, 234, "Input",ExpressionUUID->"69954569-88e6-8b4a-9d99-7647568609aa"],
Cell[19230, 460, 774, 19, 120, "Input",ExpressionUUID->"5a72cde6-a05b-4748-ae24-08b0e390ffac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20041, 484, 235, 4, 53, "Subsection",ExpressionUUID->"5d5e269c-d4be-0943-ade6-7ebaea7eb871"],
Cell[CellGroupData[{
Cell[20301, 492, 954, 24, 155, "Code",ExpressionUUID->"44e441b8-0139-e24c-b864-2f59c3e8c758"],
Cell[21258, 518, 731, 15, 26, "Message",ExpressionUUID->"66ce04e8-825c-2d4a-9e08-bd39b93a9f5e"]
}, Open  ]],
Cell[22004, 536, 1019, 27, 155, "Code",ExpressionUUID->"c296e610-5394-ab4e-aab4-f1c67b022e76"],
Cell[23026, 565, 1086, 28, 155, "Code",ExpressionUUID->"a4c01c54-5138-dc43-a525-b3388c0ce0a9"],
Cell[24115, 595, 1084, 28, 155, "Code",ExpressionUUID->"ae70b1a8-e63a-834a-86c9-57e174c3522a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25248, 629, 162, 3, 66, "Section",ExpressionUUID->"f6fbdc82-12a3-d349-b94e-342f3238932d"],
Cell[25413, 634, 10150, 215, 1071, "Input",ExpressionUUID->"cf6aee44-a54b-6346-bfc9-97b3224c00dc"],
Cell[CellGroupData[{
Cell[35588, 853, 161, 3, 53, "Subsection",ExpressionUUID->"58662d84-36a4-a84c-9230-fe69d04e9e62"],
Cell[35752, 858, 1383, 28, 158, "Input",ExpressionUUID->"d6f7aa41-6a3a-6047-a952-387b66a8a283"],
Cell[CellGroupData[{
Cell[37160, 890, 163, 3, 43, "Subsubsection",ExpressionUUID->"5f33e214-081a-b344-a7b7-dde9b886598c"],
Cell[37326, 895, 772, 18, 63, "Input",ExpressionUUID->"80bc644c-ac11-9949-aebf-bd41597109e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38135, 918, 210, 4, 43, "Subsubsection",ExpressionUUID->"ca93fd57-311f-a747-9ebb-fd8ec75ff6d8"],
Cell[38348, 924, 2047, 43, 120, "Input",ExpressionUUID->"61d20228-fb2b-8a46-a632-872e04206e6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40432, 972, 256, 4, 43, "Subsubsection",ExpressionUUID->"2933cafb-3861-f748-badb-161f8cd4ed82"],
Cell[40691, 978, 2088, 44, 120, "Input",ExpressionUUID->"7257d6ab-94d2-b842-8079-046fa19e5f9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42816, 1027, 261, 4, 43, "Subsubsection",ExpressionUUID->"60eb5ae1-3fcf-fa48-aa4b-6fe82805991a"],
Cell[43080, 1033, 2582, 51, 120, "Input",ExpressionUUID->"b83b1d54-8f4b-9947-99f9-2d1114503f4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45699, 1089, 312, 5, 43, "Subsubsection",ExpressionUUID->"a0ad1ec9-da6c-a841-8a75-249dee816538"],
Cell[46014, 1096, 2177, 46, 120, "Input",ExpressionUUID->"830a25de-2f54-5a4d-8973-47d68770032e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48252, 1149, 161, 3, 66, "Section",ExpressionUUID->"01561d2d-a773-7e4e-86fa-fb048a77985a"],
Cell[48416, 1154, 340, 7, 33, "Text",ExpressionUUID->"bac24293-f12a-3348-9450-15b07ba3d66a"],
Cell[CellGroupData[{
Cell[48781, 1165, 322, 5, 43, "Subsubsection",ExpressionUUID->"5593a267-c74a-794a-b682-e38c07bb45bc"],
Cell[49106, 1172, 3439, 67, 291, "Input",ExpressionUUID->"feac1d2e-16a0-fc4f-884d-9b868c04e6ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52582, 1244, 389, 6, 43, "Subsubsection",ExpressionUUID->"700b174a-e0f4-9e40-bd05-7f02cd71e586"],
Cell[52974, 1252, 3619, 69, 291, "Input",ExpressionUUID->"eb117506-326a-954d-bc35-a47b2069c395"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56642, 1327, 213, 4, 66, "Section",ExpressionUUID->"6fed0b4c-c817-0041-a636-9f9aeee641cf"],
Cell[56858, 1333, 10487, 222, 1090, "Input",ExpressionUUID->"99d35d54-a708-c042-b51a-cd759e9909be"],
Cell[CellGroupData[{
Cell[67370, 1559, 2184, 58, 256, "Input",ExpressionUUID->"ffaa09c9-98b6-3045-a2d3-97c1e201ce23"],
Cell[69557, 1619, 929, 25, 46, "Output",ExpressionUUID->"d1cc408d-be1a-634e-aa2e-b6b16a226f50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70523, 1649, 249, 5, 28, "Input",ExpressionUUID->"81103101-d667-364b-9cba-729d9ee057f6"],
Cell[70775, 1656, 196, 3, 32, "Output",ExpressionUUID->"aaf2a1ba-98e7-2645-a538-ce2c58e90eef"]
}, Open  ]]
}, Open  ]]
}
]
*)

